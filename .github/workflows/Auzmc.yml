name: Continuous Persistent VPS
 
on:
Â Â schedule:
Â Â Â Â - cron: '0 */6 * * *'Â Â # Every 6 hours
Â Â workflow_dispatch:
 
jobs:
Â Â vps-session:
Â Â Â Â runs-on: ubuntu-latest
Â Â Â Â timeout-minutes: 350Â Â # Just under 6 hours
 
Â Â Â Â steps:
Â Â Â Â Â Â - name: Checkout repo
Â Â Â Â Â Â Â Â uses: actions/checkout@v4
 
Â Â Â Â Â Â - name: Set hostname to biralo
Â Â Â Â Â Â Â Â run: sudo hostnamectl set-hostname biralo
 
Â Â Â Â Â Â - name: Download VPS backup (if any)
Â Â Â Â Â Â Â Â uses: actions/download-artifact@v4
Â Â Â Â Â Â Â Â with:
Â Â Â Â Â Â Â Â Â Â name: vps-backup
Â Â Â Â Â Â Â Â Â Â path: ./backup
Â Â Â Â Â Â Â Â continue-on-error: true
 
Â Â Â Â Â Â - name: Install prerequisites
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â sudo apt update
Â Â Â Â Â Â Â Â Â Â sudo apt install -y tmate curl unzip sudo net-tools neofetch
 
Â Â Â Â Â Â - name: Install Tailscale official script
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â curl -fsSL https://tailscale.com/install.sh | sh
 
Â Â Â Â Â Â - name: Restore backup files
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â if [ -f ./backup/backup.zip ]; then
Â Â Â Â Â Â Â Â Â Â Â Â unzip -o ./backup/backup.zip -d /
Â Â Â Â Â Â Â Â Â Â else
Â Â Â Â Â Â Â Â Â Â Â Â echo "No backup found, starting fresh"
Â Â Â Â Â Â Â Â Â Â fi
 
Â Â Â Â Â Â - name: Restore Tailscale state
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â if [ -f /opt/vps-backup/data/tailscaled.state ]; then
Â Â Â Â Â Â Â Â Â Â Â Â sudo mkdir -p /var/lib/tailscale
Â Â Â Â Â Â Â Â Â Â Â Â sudo cp /opt/vps-backup/data/tailscaled.state /var/lib/tailscale/tailscaled.state
Â Â Â Â Â Â Â Â Â Â Â Â sudo chmod 600 /var/lib/tailscale/tailscaled.state
Â Â Â Â Â Â Â Â Â Â fi
 
Â Â Â Â Â Â - name: Start Tailscale
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â sudo tailscaled &
Â Â Â Â Â Â Â Â Â Â sleep 8
Â Â Â Â Â Â Â Â Â Â sudo tailscale up --authkey ${{ secrets.TAILSCALE_AUTHKEY }} --hostname=biralo || echo "Tailscale already up"
 
Â Â Â Â Â Â - name: Create user biralo with sudo
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â if ! id -u biralo >/dev/null 2>&1; then
Â Â Â Â Â Â Â Â Â Â Â Â sudo useradd -m -s /bin/bash biralo
Â Â Â Â Â Â Â Â Â Â Â Â echo "biralo:biralo" | sudo chpasswd
Â Â Â Â Â Â Â Â Â Â Â Â sudo usermod -aG sudo biralo
Â Â Â Â Â Â Â Â Â Â Â Â echo "biralo ALL=(ALL) NOPASSWD:ALL" | sudo tee /etc/sudoers.d/biralo
Â Â Â Â Â Â Â Â Â Â fi
 
Â Â Â Â Â Â - name: Start tmate session for SSH access
Â Â Â Â Â Â Â Â uses: mxschmitt/action-tmate@v3
 
Â Â Â Â Â Â - name: Show Tailscale IP and tmate info
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â echo "ðŸ”— Tailscale IP:"
Â Â Â Â Â Â Â Â Â Â tailscale ip -4 || echo "Tailscale IP not found"
Â Â Â Â Â Â Â Â Â Â echo ""
Â Â Â Â Â Â Â Â Â Â echo "ðŸ”‘ tmate SSH session:"
Â Â Â Â Â Â Â Â Â Â cat $HOME/.tmate.sock/ssh
 
Â Â Â Â Â Â - name: Sleep to keep VPS alive
Â Â Â Â Â Â Â Â run: sleep 21600Â Â # 6 hours
 
Â Â Â Â Â Â - name: Backup VPS data and tailscale state
Â Â Â Â Â Â Â Â run: |
Â Â Â Â Â Â Â Â Â Â sudo mkdir -p /opt/vps-backup/data
Â Â Â Â Â Â Â Â Â Â sudo cp /var/lib/tailscale/tailscaled.state /opt/vps-backup/data/
Â Â Â Â Â Â Â Â Â Â sudo chown -R $USER:$USER /opt/vps-backup
Â Â Â Â Â Â Â Â Â Â zip -r backup.zip /opt/vps-backup
 
Â Â Â Â Â Â - name: Upload VPS backup artifact
Â Â Â Â Â Â Â Â uses: actions/upload-artifact@v4
Â Â Â Â Â Â Â Â with:
Â Â Â Â Â Â Â Â Â Â name: vps-backup
Â Â Â Â Â Â Â Â Â Â path: backup.zip
 
 
TAILSCALE_AUTHKEY
 
your key inside it 
 
https://github.com/How2MCoffc/Get-SSL-at-localhost
 
 
https://pterodactyl.io/
